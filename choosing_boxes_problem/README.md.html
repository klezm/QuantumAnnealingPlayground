<h1 id="choosing-boxes">Choosing Boxes</h1>
<h3 id="problem">Problem</h3>
<p>The problem “Choosing Boxes” is described in the <a href="https://www.dwavesys.com/media/bu0lh5ee/problem-formulation-guide-2022-01-10.pdf">D-Wave problem formulation guide</a> in chapt. 4.4.</p>
<details>
<p><summary> Choosing Boxes Problem </summary></p>
<h4 id="example-choosing-boxes">Example: Choosing Boxes</h4>
<p>We’re given three boxes with different weights. We want to choose the two boxes with the smallest sum.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Box 1</th>
<th>Box 2</th>
<th>Box 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Weight</td>
<td>15</td>
<td>20</td>
<td>25</td>
</tr>
</tbody>
</table>
<p>This is a simple problem – we know that the answer is to choose boxes 15 and 20. But how do we phrase this problem as a BQM?</p>
<h5 id="step-1-write-objective-and-constraints">Step 1: Write Objective and Constraints</h5>
<p><strong>Objective</strong>: We are looking for the smallest sum, so our objective is “minimize the sum of the boxes chosen”.<br />
<strong>Constraint</strong>: We are allowed to choose two boxes, so our constraint is “choose exactly two boxes”.</p>
<h5 id="step-2-convert-objective-and-constraints-into-binary-math-expressions">Step 2: Convert Objective and Constraints into Binary Math Expressions</h5>
<p><strong>Binary Variables.</strong> First, we need to define our binary variables. The answer that we are looking for is which boxes we should choose. For each box, we can ask “do we choose this box?”. This points us to how we should define our binary variables.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th>Use Box i</th>
<th>Don’t use Box i</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>QUBO</td>
<td><span class="math inline"><em>x</em><sub><em>i</em></sub> = 1</span></td>
<td><span class="math inline"><em>x</em><sub><em>i</em></sub> = 0</span></td>
</tr>
<tr class="even">
<td>Ising</td>
<td><span class="math inline"><em>s</em><sub><em>i</em></sub> =  + 1</span></td>
<td><span class="math inline"><em>s</em><sub><em>i</em></sub> =  − 1</span></td>
</tr>
</tbody>
</table>
<p>Once we have defined our binary variables, we can convert our objective and constraint into math expressions.</p>
<p><strong>Objective.</strong> We consider our objective for both QUBO and Ising forms.</p>
<p><strong>QUBO:</strong> To figure out the sum of the boxes that are chosen, we can use a weighted sum: <span class="math inline">15<em>x</em><sub>1</sub> + 20<em>x</em><sub>2</sub> + 25<em>x</em><sub>3</sub></span>. In this sum, the boxes that are chosen will have <span class="math inline"><em>x</em><sub><em>i</em></sub> = 1</span> and the boxes that are not chosen will have <span class="math inline"><em>x</em><sub><em>i</em></sub> = 0</span>. In other words, the value of boxes that are not chosen will be multiplied by zero and so we will only be adding up the value of the boxes that are chosen. Our objective function becomes:</p>
<p><br /><span class="math display"><em>m</em><em>i</em><em>n</em>(15<em>x</em><sub>1</sub> + 20<em>x</em><sub>2</sub> + 25<em>x</em><sub>3</sub>)</span><br /></p>
<p><strong>Ising:</strong> Using our binary variables, we can convert our +1/-1 to 1/0 using the Ising to QUBO translation shown earlier, which maps +1 7→ 1 and −1 7→ 0. Our objective function can then be written as:</p>
<p><br /><span class="math display">$$
min \left (
  15 \left ( \frac{s_1 + 1}{2} \right ) +
  20 \left ( \frac{s_2 + 1}{2} \right ) +
  25 \left ( \frac{s_3 + 1}{2} \right )
\right )
$$</span><br /></p>
<p><strong>Constraint.</strong> We consider our constraint for both QUBO and Ising forms.</p>
<p><strong>QUBO:</strong> Our constraint “choose exactly two boxes” means that we need exactly two of our binary variables to have value 1, and the remaining binary variable will have value 0. In other words, our constraint can be written as:</p>
<p><br /><span class="math display"><em>x</em><sub>1</sub> + <em>x</em><sub>2</sub> + <em>x</em><sub>3</sub> = 2</span><br /></p>
<p><strong>Ising:</strong> Our constraint “choose exactly two boxes” means that we need exactly two of our binary variables to have value +1, and the remaining binary variable will have value -1. In other words, our constraint can be written as:</p>
<p><br /><span class="math display"><em>s</em><sub>1</sub> + <em>s</em><sub>2</sub> + <em>s</em><sub>3</sub> = 1</span><br /></p>
<h5 id="step-3-transform-math-expressions-into-a-bqm">Step 3: Transform Math Expressions into a BQM</h5>
<p>Our objective function is fine as written, so we only need to modify our constraint.</p>
<p><strong>QUBO:</strong> To modify our constraint, we need to use the method for equalities. Original constraint: <br /><span class="math display"><em>x</em><sub>1</sub> + <em>x</em><sub>2</sub> + <em>x</em><sub>3</sub> = 2</span><br /> Move everything to one side: <br /><span class="math display"><em>x</em><sub>1</sub> + <em>x</em><sub>2</sub> + <em>x</em><sub>3</sub> − 2 = 0</span><br /> Square the expression: <br /><span class="math display">(<em>x</em><sub>1</sub> + <em>x</em><sub>2</sub> + <em>x</em><sub>3</sub> − 2)<sup>2</sup></span><br /></p>
<p><strong>Ising:</strong> Following the same method, we can rewrite our constraint as follows. <br /><span class="math display">(<em>s</em><sub>1</sub> + <em>s</em><sub>2</sub> + <em>s</em><sub>3</sub> − 1)<sup>2</sup></span><br /></p>
<h5 id="step-4-combine-expressions">Step 4: Combine Expressions</h5>
<p>Now that we have written our objective and constraint in BQM form, we can combine them together to make our final model using addition and adding in a Lagrange parameter. Both of these can be expanded and simplified to prepare for input to an Ocean python program.</p>
<p><strong>QUBO:</strong> <br /><span class="math display"><em>m</em><em>i</em><em>n</em>((15<em>x</em><sub>1</sub>+20<em>x</em><sub>2</sub>+25<em>x</em><sub>3</sub>)+<em>γ</em>(<em>x</em><sub>1</sub>+<em>x</em><sub>2</sub>+<em>x</em><sub>3</sub>−2)<sup>2</sup>)</span><br /></p>
<p><strong>Ising:</strong></p>
<p><br /><span class="math display">$$
min \left (
  15 \left ( \frac{s_1 + 1}{2} \right ) +
  20 \left ( \frac{s_2 + 1}{2} \right ) +
  25 \left ( \frac{s_3 + 1}{2} \right ) +
  γ (s_1 + s_2 + s_3 − 1)^2
\right )
$$</span><br /></p>
</details>
<p>Also see: <a href="https://github.com/dwave-training/choosing-boxes">https://github.com/dwave-training/choosing-boxes</a></p>
<h3 id="code">Code</h3>
<p>The code for the problem is in <code>choosing_boxes.ipynb</code> <!-- [choosing_boxes.ipynb](choosing_boxes_problem/choosing_boxes.ipynb) --> which can be viewed at <a href="https://nbviewer.org/github/klezm/QuantumAnnealingPlayground/blob/main/choosing_boxes_problem/choosing_boxes.ipynb">nbviewer.org</a> or opened in the <a href="https://ide.dwavesys.io/#https://github.com/klezm/QuantumAnnealingPlayground">D-Wave Leap IDE</a></p>
<h3 id="visualization">Visualization</h3>
<p>The eigenspectrum and eigenvector for this problem are visualized for different Lagrange multipliers γ:</p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 23%" />
<col style="width: 4%" />
<col style="width: 21%" />
<col style="width: 21%" />
<col style="width: 21%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th></th>
<th></th>
<th>50 steps</th>
<th>100 steps</th>
<th>200 steps</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Choose 2 out of 3</td>
<td>Annealing Schedule starting <br> at 0 and ending at 0</td>
<td>Eigenspectrum</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of3_γ5-80_Δt50_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of3_γ5-80_Δt100_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of3_γ5-80_Δt200_sched-similar.html">link</a></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>Eigenvectors</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of3_γ5-80_Δt50_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of3_γ5-80_Δt100_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of3_γ5-80_Δt200_sched-similar.html">link</a></td>
</tr>
<tr class="odd">
<td></td>
<td>Annealing Schedule starting <br> above 0 and ending at 0 (like D-Wave)</td>
<td>Eigenspectrum</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of3_γ5-80_Δt50_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of3_γ5-80_Δt100_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of3_γ5-80_Δt200_sched-approx.html">link</a></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>Eigenvectors</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of3_γ5-80_Δt50_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of3_γ5-80_Δt100_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of3_γ5-80_Δt200_sched-approx.html">link</a></td>
</tr>
<tr class="odd">
<td>Choose 1 out of 2</td>
<td>Annealing Schedule starting <br> at 0 and ending at 0</td>
<td>Eigenspectrum</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of2_γ5-80_Δt50_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of2_γ5-80_Δt100_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of2_γ5-80_Δt200_sched-similar.html">link</a></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>Eigenvectors</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of2_γ5-80_Δt50_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of2_γ5-80_Δt100_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of2_γ5-80_Δt200_sched-similar.html">link</a></td>
</tr>
<tr class="odd">
<td></td>
<td>Annealing Schedule starting <br> above 0 and ending at 0 (like D-Wave)</td>
<td>Eigenspectrum</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of2_γ5-80_Δt50_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of2_γ5-80_Δt100_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of2_γ5-80_Δt200_sched-approx.html">link</a></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>Eigenvectors</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of2_γ5-80_Δt50_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of2_γ5-80_Δt100_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of2_γ5-80_Δt200_sched-approx.html">link</a></td>
</tr>
<tr class="odd">
<td>Choose 2 out of 4</td>
<td>Annealing Schedule starting <br> at 0 and ending at 0</td>
<td>Eigenspectrum</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of4_γ5-80_Δt50_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of4_γ5-80_Δt100_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of4_γ5-80_Δt200_sched-similar.html">link</a></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>Eigenvectors</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of4_γ5-80_Δt50_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of4_γ5-80_Δt100_sched-similar.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of4_γ5-80_Δt200_sched-similar.html">link</a></td>
</tr>
<tr class="odd">
<td></td>
<td>Annealing Schedule starting <br> above 0 and ending at 0 (like D-Wave)</td>
<td>Eigenspectrum</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of4_γ5-80_Δt50_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of4_γ5-80_Δt100_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-choose-2of4_γ5-80_Δt200_sched-approx.html">link</a></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td>Eigenvectors</td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of4_γ5-80_Δt50_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of4_γ5-80_Δt100_sched-approx.html">link</a></td>
<td><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-choose-2of4_γ5-80_Δt200_sched-approx.html">link</a></td>
</tr>
</tbody>
</table>
<p>Old Plots:</p>
<ul>
<li>Choosing Boxes Problem with 3 Boxes (pick 2 with min weight)
<ul>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums.html">eigenspectrums.html</a></li>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums3D.html">eigenspectrums3D.html</a></li>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors.html">eigenvectors.html</a></li>
<li>With 100 Time Steps
<ul>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-dt100.html">eigenspectrums</a></li>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-dt100.html">eigenvectors</a></li>
</ul></li>
<li>With 200 Time Steps
<ul>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenspectrums-dt200.html">eigenspectrums</a></li>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/eigenvectors-dt200.html">eigenvectors</a></li>
</ul></li>
</ul></li>
<li>Choosing Boxes Problem with 2 Boxes (pick the lighter one)
<ul>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/choosing-boxes-2-eigenspectrums-dt50.html">choosing-boxes-2-eigenspectrums-dt50</a></li>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/choosing-boxes-2-eigenvectors-dt50.html">choosing-boxes-2-eigenvectors-dt50</a></li>
</ul></li>
<li>Choosing Boxes Problem with 4 Boxes (pick 2 with min weight)
<ul>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/choosing-boxes-4-eigenspectrums-dt50.html">choosing-boxes-4-eigenspectrums-dt50</a></li>
<li><a href="https://klezm.github.io/QuantumAnnealingPlayground/choosing_boxes_problem/results/choosing-boxes-4-eigenvectors-dt50.html">choosing-boxes-4-eigenvectors-dt50</a></li>
</ul></li>
</ul>
